azr:
  image: "vastai/base-image:@vastai-automatic-tag"
  model_id: "deepcogito/cogito-v1-preview-llama-8b"
  quantization: "4bit"
  lora:
    r: 16
    alpha: 32
    target_modules: ["q_proj", "v_proj"]

  rlhf:
    num_generations: 4
    max_prompt_length: 2048
    max_completion_length: 1024
    importance_sampling_level: "sequence"
    clip_range_ratio: 0.1
    kl_coeff: 0.0
    bf16: true
    gradient_accumulation_steps: 8

  sandbox:
    timeout_s: 2
    memory_mb: 256
    max_tool_turns: 6

  web:
    max_bytes: 800000
    user_agent: "AZR-Research/1.0 (+no-bots)"
    headless: true

self_play:
  enabled: false
  weight: 0.2
  device: "cuda:1"
  use_tool_loop: false
  tie_breakers: ["pass_rate", "code_length"]
  update:
    every_calls: 0
    strategy: "copy_lora"

hardware:
  gpus:
    - name: "RTX 6000 Ada"
      tflops_fp16: 162.8
      vram_gb: 48
      mem_bw_gbps: 764.4
      pcie: "Gen4 x16 ~25 GB/s"
  cpu:
    model: "AMD EPYC 7352"
    cores: 24
  system_ram_gb: 172
  storage: "SAMSUNG MZ1L21T9HCLS-00A07"
